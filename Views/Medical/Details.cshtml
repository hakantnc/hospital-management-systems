@model HospitalSystem.Models.MedicalRecord

@{
    ViewBag.Title = "Muayene Detayı";
}

<div class="row">
    <div class="col-md-12">
        <div class="panel panel-info">
            <div class="panel-heading">
                <h3 class="panel-title">Muayene Raporu (#@Model.RecordID)</h3>
            </div>
            <div class="panel-body">
                <dl class="dl-horizontal">
                    <dt>Hasta:</dt>
                    <dd>@Model.Patient.User.FirstName @Model.Patient.User.LastName</dd>

                    <dt>Doktor:</dt>
                    <dd>Dr. @Model.Doctor.User.FirstName @Model.Doctor.User.LastName</dd>

                    <dt>Tarih:</dt>
                    <dd>@Model.VisitDate.ToString("dd.MM.yyyy")</dd>

                   

                    <dt>Belirtiler:</dt>
                    <dd>@Model.Symptoms</dd>

                    <dt>Teşhis:</dt>
                    <dd class="text-danger"><strong>@Model.Diagnosis</strong></dd>

                    <dt>Notlar:</dt>
                    <dd>@Model.DoctorNotes</dd>
                </dl>
            </div>
        </div>
    </div>
</div>

<div class="row">
    <div class="col-md-6">
        <h3>Reçete (İlaçlar)</h3>
        <table class="table table-bordered table-striped">
            <thead>
                <tr>
                    <th>İlaç Adı</th>
                    <th>Dozaj</th>
                    <th>Talimat</th>
                </tr>
            </thead>
            <tbody>
                @if (Model.Prescriptions.Count == 0)
                {
                    <tr><td colspan="3" class="text-muted">Bu kayıtta henüz ilaç yok.</td></tr>
                }
                else
                {
                    foreach (var item in Model.Prescriptions)
                    {
                        <tr>
                            <td>@item.MedicationName</td>
                            <td>@item.Dosage</td>
                            <td>@item.Instructions</td>
                        </tr>
                    }
                }
            </tbody>
        </table>
    </div>

    @if (Session["UserRole"] != null && Session["UserRole"].ToString() == "Doctor")
    {
        <div class="col-md-6">
            <div class="well">
                <h4>Yeni İlaç Ekle</h4>
                @using (Html.BeginForm("AddPrescription", "Medical", FormMethod.Post))
                {
                    @Html.AntiForgeryToken()

                    <input type="hidden" name="RecordID" value="@Model.RecordID" />

                    <div class="form-group">
                        <label>İlaç Adı</label>
                        <input type="text" name="MedicationName" class="form-control" required placeholder="Örn: Parol" />
                    </div>

                    <div class="form-group">
                        <label>Dozaj</label>
                        <input type="text" name="Dosage" class="form-control" required placeholder="Örn: 500mg" />
                    </div>

                    <div class="form-group">
                        <label>Kullanım Talimatı</label>
                        <input type="text" name="Instructions" class="form-control" required placeholder="Örn: Sabah akşam tok karnına" />
                    </div>

                    <button type="submit" class="btn btn-primary btn-sm">Listeye Ekle</button>
                }
            </div>
        </div>
    }
</div>

<p>
    @if (Session["UserRole"].ToString() == "Doctor")
    {
        @Html.ActionLink("Doktor Paneline Dön", "Index", "Doctor", null, new { @class = "btn btn-default" })
    }
    else
    {
        @Html.ActionLink("Geçmişime Dön", "History", null, new { @class = "btn btn-default" })
    }
</p>